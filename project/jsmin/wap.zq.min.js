!function(t){function i(){var i=t(window).width();i=i>720?720:i,n=i/7.2}var n,s="dev",e=60;e="dev"===s?80:60;var a="20180420001";i(),t(window).resize(i);var o={getMoreList:function(i,n,s){var e="//db2.gamersky.com/LabelJsonpAjax.aspx";t.ajax({type:"get",dataType:"jsonp",url:e,data:i,beforeSend:function(){"function"==typeof s&&s()},success:function(t){"function"==typeof n&&n(t)},error:function(t){console.log(t)}})},getRating:function(i,n,s){var e="//cm1.gamersky.com/apirating/getplayersscore";t.ajax({type:"get",dataType:"jsonp",url:e,data:i,beforeSend:function(){"function"==typeof s&&s()},success:function(t){"function"==typeof n&&n(t)},error:function(t){console.log(t)}})}};t.fn.extend({gsZqNav:function(){function i(){a.find("a").on("tap",function(){var i=t(this),n=i.data("to");t("html,body").animate({scrollTop:t("."+n).offset().top-c},200)})}function n(i){a.find("a").each(function(){var n=t(this),s=n.data("to"),e=t("."+s).offset().top;i>e-50&&(a.find("a").removeClass("cur"),n.addClass("cur"))})}function s(t){var i=o.offset().top;t>i?a.addClass("cur"):a.removeClass("cur")}function e(t){}var a=t(this),o=a.closest(".gsZqNavPlaceholder"),c=o.height(),d=t("#gsSCMexist").length;i(),s(0),t(window).scroll(function(){var i=t(window).scrollTop();s(i),n(i),d>0&&e(i)})},gsZqInfoPlatformTime:function(){this.each(function(){function i(i){var n=e.find(".gsZqGameInfoPlatBox"),s="",a="",o="";a+='<p class="gsZqGameInfoPlat">平台：',o+='<div class="time gsZqGameInfoTime">',t.each(i,function(t,i){var n="";n=0===t?"cur":"",a+='<a class="'+n+'">'+i.pt+"</a>",o+='<p class="'+n+'">上市：'+i.showtime+"("+i.pt+") </p>"}),a+="</p>",o+="</div>",s+=a,s+=o,n.html(s)}function n(){var i=e.find(".gsZqGameInfoPlat"),n=e.find(".gsZqGameInfoTime");i.find("a").on("tap",function(){var s=t(this).index();i.find("a").removeClass("cur").eq(s).addClass("cur"),n.find("p").removeClass("cur").eq(s).addClass("cur")})}function s(){var s=[];t("#dataTimeArea").find("li").each(function(){var i,n=t(this).find("a");i={pt:n.text(),time:n.data("time"),showtime:n.data("showtime")},s.push(i)}),i(s),n()}var e=t(this);s()})},gsZqInfoIntro:function(){this.each(function(){var i=t(this),n=i.find(".gsZqGameInfoIntroMore"),s="<p>";i.find("p").each(function(i){s+=t(this).text().replace("　　",""),0===i&&(s+="：")}).remove(),s+="</p>",s=s.replace(/：：/g,"："),t(".gsZqGameInfoIntroHolder").hide(),i.append(s).show(),n.on("tap",function(){i.addClass("cur")})})},gsZqSwp:function(){this.each(function(){var i=t(this),n=i.find(".gsZqSwp");new Swiper(n,{slidesPerView:"auto",freeMode:!0,freeModeSticky:!0})})},gsZqTab:function(){this.each(function(){var i=t(this),n=i.find(".gztNav"),s=i.find(".gztBox");n.find(".gztNavBtn").on("tap",function(){var i=t(this).index();n.find(".gztNavBtn").removeClass("cur").eq(i).addClass("cur"),s.find(".gztItem").removeClass("cur").eq(i).addClass("cur")})})},gsZqGl:function(){function i(i){var s="";s+='<div class="gs-zq-gl-quick">',e.find(".gs_sc_item").map(function(i){var n=t(this);s+='<a class="gsZqGlQuickBtn" data-idx="'+i+'">'+n.find(".gs_sc_item_btn").text()+"</a>"}),s+="</div>",e.find(".gsZqGlQuick").html(s),e.find(".gsZqGlQuickBtn").on("tap",function(){var s,a=t(this).data("idx");i===!0?(e.find(".gsZqGlBoxMore").remove(),e.find(".gs_sc_item:gt(1)").show(),s=e.find(".gs_sc_item").eq(a).offset().top-.7*n):s=e.find(".gs_sc_item").eq(a).offset().top,t("html,body").animate({scrollTop:s},200)})}function s(){var i=e.find(".gs_sc_item:gt(1)");i.hide(),e.find(".zq-strategy-collect").append('<a class="gs-zq-more gs-zq-more-blue gsZqGlBoxMore">更多</a>'),e.find(".gsZqGlBoxMore").on("tap",function(){t(this).remove(),i.show()})}var e=t(this);t(".ymw-tags").removeClass(),e.find("#gsSCMexist").length<=0?(e.hide(),t(".gsZqNav").find(".gsZqNavGl").remove()):(e.find(".collectbox").show().find(".gs_strategy_collect").removeClass().addClass("zq-strategy-collect"),e.find(".gs_sc_item_list").each(function(){t(this).find("li:gt(3)").remove()}),e.find("a").each(function(){var i=t(this),n=i.attr("waphref");i.attr("href",n)}),e.find(".gs_sc_item").length>2&&t("#gsZqStrategyShow").length<1&&s(),t("#gsZqStrategyShow").length>0?i():i(!0))},gsZqGetCommentCount:function(){var i="";t(".gsZqComment").each(function(){var n=t(this),s=n.attr("data-sid"),e=n.attr("data-add");""!==i&&(i+=","),"yes"!==e&&(i+=s)}),""!==i&&t.ajax({type:"GET",url:"//cm.gamersky.com/commentapi/count",dataType:"jsonp",data:{topic_source_id:i},success:function(i){t(".gsZqComment").each(function(){var n=t(this);if(i.result.hasOwnProperty(n.attr("data-sid"))){var s=i.result[n.attr("data-sid")];n.text(s.comments).attr("data-add","yes")}})}})},gsZqAddLoading:function(){var t="";t='<div class="gs-zq-loading gsZqLoading"></div>',this.append(t)},gsZqRemoveLoading:function(){t(".gsZqLoading").remove()},gsZqGetMoreOnceTag:function(){this.each(function(){function i(t,i){n.hide(),s.gsZqAddLoading(),setTimeout(function(){s.find(".gsZqListCount").eq(t).show(),s.gsZqRemoveLoading(),n.show(),t>=i-1?n.addClass("gs-zq-more-done").html("全部加载完成"):e=!0},500)}var n=t(this),s=t("."+n.data("tar")),e=!0,a=s.find(".gsZqListCount").length;n.attr({"data-page":0,"data-total":a}),a<2&&(n.addClass("gs-zq-more-done").html("全部加载完成"),e=!1),n.on("tap",function(){var n=t(this),s=n.attr("data-page"),a=n.attr("data-total");e===!0&&(e=!1,s<a&&(s++,n.attr("data-page",s),i(s,a)))})})},gsZqGetMoreOnce:function(){this.each(function(){function i(){n.hide(),e.gsZqAddLoading(),setTimeout(function(){e.find("ul li").show(),e.gsZqRemoveLoading(),n.show().addClass("gs-zq-more-all").html("查看全部").attr({href:s,target:"_blank"})},500)}var n=t(this),s=n.data("href"),e=t("."+n.data("tar"));n.on("tap",function(){n.off(),i()})})},gsZqGetMore:function(){this.each(function(){function i(){var i,d,r=a.attr("data-page");r++,d={type:"templatekeylabel",isCache:!0,cacheTime:e,templatekey:n,id:s,page:r},i={jsondata:JSON.stringify(d)},o.getMoreList(i,function(i){if("ok"===i.status){var n=i.body;n.indexOf("没有任何记录")>0?a.show().addClass("gs-zq-more-done").html("全部加载完成").off():(c.find("ul").append(n),t(".gsZqComment").gsZqGetCommentCount())}c.gsZqRemoveLoading(),a.show().attr({"data-page":r})},function(){a.hide(),c.gsZqAddLoading()})}var n,s,a=t(this),c=t("."+a.data("tar"));n=a.data("tmk"),s=a.data("nid"),a.on("tap",function(){i()})})},gsZqSetMinHeight:function(){function i(){var i,s=n.outerHeight()-n.height(),e=t(window).height(),a=n.offset().top,o=t(".ymw-footer").outerHeight();i=e-a-o-s,n.css({"min-height":i})}var n=this;i(),t(window).resize(i)},gsZqGetRating:function(){var i,n,s=this;n={genneralId:s.attr("data-gameid"),num:"10"},i={jsondata:JSON.stringify(n)},o.getRating(i,function(i){if("ok"===i.status){var n,e=i.sorce,a="";n=10*parseFloat(e)+"","--"!==e&&"已上市"===t("#dataTimeArea").attr("date-selltime")?("100"===n?(a+='<i class="pnm pnm1"></i>',a+='<i class="pnm pnm0"></i>',s.show().find(".gsZqRatingNum").addClass("gs-zp-rating-num-full")):(a+='<i class="pnm pnm'+n[0]+'"></i>',a+='<i class="dot"></i>',a+='<i class="pnm pnm'+n[1]+'"></i>'),s.show().find(".gsZqRatingNum").html(a)):s.remove()}})},gsZqCreatePic:function(){function i(){var i=t("#demo0").find(".piclist");i.find("a").each(function(){var i=t(this),n=i.attr("data-pic"),s=i.find("img").attr("src"),e={};e.pic={small:n,tiny:s,origin:s.replace("_tiny",""),sizeW:1e3,sizeH:534},o.push(e)})}function n(){c.photoSwp(o)}var s=t("#gsZpImages"),e="",o=[];if(i(),e+='<div class="gs-zq-images ">',e+='<div class="gs-zq-title-lev1">图库</div>',e+='<div class="gs-zq-swp gsZqSwpPicDad">',e+='<div class="swiper-container gsZqSwp">',e+='<div class="swiper-wrapper">',t.each(o,function(t,i){e+='<div class="swiper-slide"><a class="gsZqPicLook" data-idx="'+t+'"><img src="'+i.pic.tiny+'" alt="gs"></a></div>'}),e+="",e+="</div></div></div></div>",s.html(e),t(".gsZqSwpPicDad").gsZqSwp(),"undefined"==typeof PhotoSwipe){var d='<link rel="stylesheet" href="//j.gamersky.com/css/??g/lib/photoswipe.min.css,g/lib/default-skin.min.css,?dtcode='+a+'"></link>';t("head").append(d),t.getScript("//j.gamersky.com/js/??g/lib/photoswipe.min.js,g/lib/photoswipe-ui-default.min.js",function(){n()})}else n()}});var c={DomExist:function(t,i){t.length>0&&"function"==typeof i&&i()},infoIntroduce:function(){this.DomExist(t(".gsZqGameInfoIntro"),function(){t(".gsZqGameInfoIntro").gsZqInfoIntro()})},infoPlatformTime:function(){this.DomExist(t(".gsZqGameInfo"),function(){t(".gsZqGameInfo").gsZqInfoPlatformTime()})},swp:function(){this.DomExist(t(".gsZqSwpDad"),function(){t(".gsZqSwpDad").gsZqSwp()})},tab:function(){this.DomExist(t(".gsZqTab"),function(){t(".gsZqTab").gsZqTab()})},gl:function(){this.DomExist(t("#gsZqStrategy"),function(){t("#gsZqStrategy").gsZqGl()})},nav:function(){this.DomExist(t(".gsZqNav"),function(){t(".gsZqNav").gsZqNav()})},moreOnce:function(){this.DomExist(t(".gsZqGetMoreOnce"),function(){t(".gsZqGetMoreOnce").gsZqGetMoreOnce()}),this.DomExist(t(".gsZqGetMoreOnceTag"),function(){t(".gsZqGetMoreOnceTag").gsZqGetMoreOnceTag()})},more:function(){this.DomExist(t(".gsZqGetMore"),function(){t(".gsZqGetMore").gsZqGetMore()})},commentCount:function(){this.DomExist(t(".gsZqComment"),function(){t(".gsZqComment").gsZqGetCommentCount()})},setMinHeight:function(){this.DomExist(t(".gsZqLp"),function(){t(".gsZqLp").gsZqSetMinHeight()})},getRating:function(){this.DomExist(t(".gsZqRating"),function(){t(".gsZqRating").gsZqGetRating()})},addSwpOnce:function(){var i='<div class="pswp pswp-zq pswpZq" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div>';i+='<div class="pswp__ui pswp__ui--hidden">',i+='<div class="pswp__bot-bar">',i+='<a class="pswp-zq-origin-btn pswpBtnOrigin pswp__single-tap" title="查看原图">查看原图</a>',i+='<a class="pswp-zq-save-btn pswpBtnSave pswp__single-tap" title="保存原图"></a>',i+="</div>",i+='<div class="pswp__top-bar">',i+='<div class="pswp__counter"></div>',i+='<button class="pswp__button pswp__button--close" title="关闭"></button>',i+='<button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="上一张"></button> <button class="pswp__button pswp__button--arrow--right" title="下一张"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div>',i+="</div></div>",t("body").append(i)},photoSwp:function(i){var n=function(n){var s=function(i){var n=[];return t.each(i,function(t,i){var s={msrc:i.pic.tiny,src:i.pic.small,w:i.pic.sizeW,h:i.pic.sizeH,ori:i.pic.origin};n.push(s)}),n},e=function(n,e,a,o,c){function d(i){t(".pswpZq").find(".pswpBtnSave").attr({target:"_blank",href:"//pic.gamersky.com/down/index?url="+f[i].ori})}function r(){t(".pswpZq").on("click",".pswpBtnOrigin",function(){t(".pswpZq").find(".pswp__img").each(function(){var i=t(this);i.attr("src")===f[u].src&&i.attr("src",f[u].ori)})})}var p,g,f,l=t(".pswpZq")[0];f=s(i),g={shareEl:!1,fullscreenEl:!1,zoomEl:!1,bgOpacity:1,showHideOpacity:0,galleryUID:a,history:!1,tapToClose:!0,tapToToggleControls:!1,index:e,getThumbBoundsFn:function(t){var i=n.find("img")[0],s=window.pageYOffset||document.documentElement.scrollTop,e=i.getBoundingClientRect();return{x:e.left,y:e.top+s,w:e.width}}},p=new PhotoSwipe(l,PhotoSwipeUI_Default,f,g),p.init();var u=0;p.listen("initialZoomIn",function(){u=p.getCurrentIndex(),d(u),t(".pswpZq").animate({opacity:1},333)}),p.listen("initialZoomOut",function(){t(".pswpZq").animate({opacity:0},200)}),p.listen("afterChange",function(){u=p.getCurrentIndex(),d(u)}),r()},a=t(n);a.attr("data-pswp-uid",1),a.find(".gsZqPicLook").on("click",function(){var i=t(this),n=i.data("idx");e(i,n,1)})};n(".gsZqSwpPicDad")},createPic:function(){var i=this;this.DomExist(t("#demo0"),function(){t("#demo0").gsZqCreatePic(),i.addSwpOnce()})},openClub:function(){var i=this,n=t("#QZCMT");""!==t.trim(n.attr("clubId"))||""!==t.trim(n.attr("topicId"))?i.DomExist(n,function(){t.getScript("//j.gamersky.com/web2015/qzcomment/js/qzcmtconfig.wap.js"),t(".gs-zq-club").addClass("gsZqNavPos4"),t(".gs-zq-ku-comm").remove()}):(t(".gs-zq-club").hide(),t(".gs-zq-ku-comm").on("click",".btnDetailMore",function(i){t(this).off(),i.preventDefault(),window.location.href=t(".gs-zq-ku-comm .gs-more").attr("href")}))},pzShowHide:function(){t("#pzMain").length>0&&t(".pz_data").find(".PZXQ").length<1&&t(".gs-zq-config").hide()},sectionShowHide:function(){function i(t,i){t.text().indexOf("没有任何记录")>0&&(t.hide().remove(),"function"==typeof i&&i())}t(".gsZqIndex").length>0&&(i(t(".gsZqArticlePc")),i(t(".gsZqDownload")),i(t(".gsZqVideo"),function(){t("#gsZpImages").find(".gs-zq-images").length>0?t("#gsZpImages").addClass("gsZqNavPos3"):t(".gsZqNavVP").remove()}))},init:function(){var t=this;t.nav(),t.infoPlatformTime(),t.infoIntroduce(),t.tab(),t.swp(),t.gl(),t.setMinHeight(),t.moreOnce(),t.more(),t.commentCount(),t.getRating(),t.createPic(),t.openClub(),t.pzShowHide(),t.sectionShowHide()}};c.init()}(jQuery);
//# sourceMappingURL=wap.zq.min.js.map
