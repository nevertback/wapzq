!function(t){function i(){var i=t(window).width();i=i>720?720:i,n=i/7.2}var n,s="dev",o=60;o="dev"===s?80:60;var e="20180420001";i(),t(window).resize(i);var a={getMoreList:function(i,n,s){var o="//db2.gamersky.com/LabelJsonpAjax.aspx";t.ajax({type:"get",dataType:"jsonp",url:o,data:i,beforeSend:function(){"function"==typeof s&&s()},success:function(t){"function"==typeof n&&n(t)},error:function(t){console.log(t)}})},getRating:function(i,n,s){var o="//cm1.gamersky.com/apirating/getplayersscore";t.ajax({type:"get",dataType:"jsonp",url:o,data:i,beforeSend:function(){"function"==typeof s&&s()},success:function(t){"function"==typeof n&&n(t)},error:function(t){console.log(t)}})}};t.fn.extend({gsZqNav:function(){function i(){e.find("a").on("tap",function(){var i=t(this),n=i.data("to");t("html,body").animate({scrollTop:t("."+n).offset().top-c},200)})}function n(i){e.find("a").each(function(){var n=t(this),s=n.data("to"),o=t("."+s).offset().top;i>o-50&&(e.find("a").removeClass("cur"),n.addClass("cur"))})}function s(t){var i=a.offset().top;t>i?e.addClass("cur"):e.removeClass("cur")}function o(t){}var e=t(this),a=e.closest(".gsZqNavPlaceholder"),c=a.height(),r=t("#gsSCMexist").length;i(),s(0),t(window).scroll(function(){var i=t(window).scrollTop();s(i),n(i),r>0&&o(i)})},gsZqInfoPlatformTime:function(){this.each(function(){function i(i){var n=o.find(".gsZqGameInfoPlatBox"),s="",e="",a="";e+='<p class="gsZqGameInfoPlat">平台：',a+='<div class="time gsZqGameInfoTime">',t.each(i,function(t,i){var n="";n=0===t?"cur":"",e+='<a class="'+n+'">'+i.pt+"</a>",a+='<p class="'+n+'">上市：'+i.showtime+"("+i.pt+") </p>"}),e+="</p>",a+="</div>",s+=e,s+=a,n.html(s)}function n(){var i=o.find(".gsZqGameInfoPlat"),n=o.find(".gsZqGameInfoTime");i.find("a").on("tap",function(){var s=t(this).index();i.find("a").removeClass("cur").eq(s).addClass("cur"),n.find("p").removeClass("cur").eq(s).addClass("cur")})}function s(){var s=[];t("#dataTimeArea").find("li").each(function(){var i,n=t(this).find("a");i={pt:n.text(),time:n.data("time"),showtime:n.data("showtime")},s.push(i)}),i(s),n()}var o=t(this);s()})},gsZqInfoIntro:function(){this.each(function(){var i=t(this),n=i.find(".gsZqGameInfoIntroMore"),s="<p>";i.find("p").each(function(i){s+=t(this).text().replace("　　",""),0===i&&(s+="：")}).remove(),s+="</p>",s=s.replace(/：：/g,"："),t(".gsZqGameInfoIntroHolder").hide(),i.append(s).show(),n.on("tap",function(){i.addClass("cur")})})},gsZqSwp:function(){this.each(function(){var i=t(this),n=i.find(".gsZqSwp");new Swiper(n,{slidesPerView:"auto",freeMode:!0,freeModeSticky:!0})})},gsZqTab:function(){this.each(function(){var i=t(this),n=i.find(".gztNav"),s=i.find(".gztBox");n.find(".gztNavBtn").on("tap",function(){var i=t(this).index();n.find(".gztNavBtn").removeClass("cur").eq(i).addClass("cur"),s.find(".gztItem").removeClass("cur").eq(i).addClass("cur")})})},gsZqGl:function(){function i(i){var s="";s+='<div class="gs-zq-gl-quick">',o.find(".gs_sc_item").map(function(i){var n=t(this);s+='<a class="gsZqGlQuickBtn" data-idx="'+i+'">'+n.find(".gs_sc_item_btn").text()+"</a>"}),s+="</div>",o.find(".gsZqGlQuick").html(s),o.find(".gsZqGlQuickBtn").on("tap",function(){var s,e=t(this).data("idx");i===!0?(o.find(".gsZqGlBoxMore").remove(),o.find(".gs_sc_item:gt(1)").show(),s=o.find(".gs_sc_item").eq(e).offset().top-.7*n):s=o.find(".gs_sc_item").eq(e).offset().top,t("html,body").animate({scrollTop:s},200)})}function s(){var i=o.find(".gs_sc_item:gt(1)");i.hide(),o.find(".zq-strategy-collect").append('<a class="gs-zq-more gs-zq-more-blue gsZqGlBoxMore">更多</a>'),o.find(".gsZqGlBoxMore").on("tap",function(){t(this).remove(),i.show()})}var o=t(this);t(".ymw-tags").removeClass(),o.find("#gsSCMexist").length<=0?(o.hide(),t(".gsZqNav").find(".gsZqNavGl").remove()):(o.find(".collectbox").show().find(".gs_strategy_collect").removeClass().addClass("zq-strategy-collect"),o.find(".gs_sc_item_list").each(function(){t(this).find("li:gt(3)").remove()}),o.find("a").each(function(){var i=t(this),n=i.attr("waphref");i.attr("href",n)}),o.find(".gs_sc_item").length>2&&t("#gsZqStrategyShow").length<1&&s(),t("#gsZqStrategyShow").length>0?i():i(!0))},gsZqGetCommentCount:function(){var i="";t(".gsZqComment").each(function(){var n=t(this),s=n.attr("data-sid"),o=n.attr("data-add");""!==i&&(i+=","),"yes"!==o&&(i+=s)}),""!==i&&t.ajax({type:"GET",url:"//cm.gamersky.com/commentapi/count",dataType:"jsonp",data:{topic_source_id:i},success:function(i){t(".gsZqComment").each(function(){var n=t(this);if(i.result.hasOwnProperty(n.attr("data-sid"))){var s=i.result[n.attr("data-sid")];n.text(s.comments).attr("data-add","yes")}})}})},gsZqAddLoading:function(){var t="";t='<div class="gs-zq-loading gsZqLoading"></div>',this.append(t)},gsZqRemoveLoading:function(){t(".gsZqLoading").remove()},gsZqGetMoreOnce:function(){this.each(function(){function i(){n.hide(),o.gsZqAddLoading(),setTimeout(function(){o.find("ul li").show(),o.gsZqRemoveLoading(),n.show().addClass("gs-zq-more-all").html("查看全部").attr({href:s,target:"_blank"})},500)}var n=t(this),s=n.data("href"),o=t("."+n.data("tar"));n.on("tap",function(){n.off(),i()})})},gsZqGetMore:function(){this.each(function(){function i(){var i,r,d=e.attr("data-page");d++,r={type:"templatekeylabel",isCache:!0,cacheTime:o,templatekey:n,id:s,page:d},i={jsondata:JSON.stringify(r)},a.getMoreList(i,function(i){if("ok"===i.status){var n=i.body;n.indexOf("没有任何记录")>0?e.show().addClass("gs-zq-more-done").html("全部加载完成").off():(c.find("ul").append(n),t(".gsZqComment").gsZqGetCommentCount())}c.gsZqRemoveLoading(),e.show().attr({"data-page":d})},function(){e.hide(),c.gsZqAddLoading()})}var n,s,e=t(this),c=t("."+e.data("tar"));n=e.data("tmk"),s=e.data("nid"),e.on("tap",function(){i()})})},gsZqSetMinHeight:function(){function i(){var i,s=n.outerHeight()-n.height(),o=t(window).height(),e=n.offset().top,a=t(".ymw-footer").outerHeight();i=o-e-a-s,n.css({"min-height":i})}var n=this;i(),t(window).resize(i)},gsZqGetRating:function(){var i,n,s=this;n={genneralId:s.attr("data-gameid"),num:"10"},i={jsondata:JSON.stringify(n)},a.getRating(i,function(i){if("ok"===i.status){var n,o=i.sorce,e="";n=10*parseFloat(o)+"","--"!==o&&"已上市"===t("#dataTimeArea").attr("date-selltime")?("100"===n?(e+='<i class="pnm pnm1"></i>',e+='<i class="pnm pnm0"></i>',s.show().find(".gsZqRatingNum").addClass("gs-zp-rating-num-full")):(e+='<i class="pnm pnm'+n[0]+'"></i>',e+='<i class="dot"></i>',e+='<i class="pnm pnm'+n[1]+'"></i>'),s.show().find(".gsZqRatingNum").html(e)):s.remove()}})},gsZqCreatePic:function(){function i(){var i=t("#demo0").find(".piclist");i.find("a").each(function(){var i=t(this),n=i.attr("data-pic"),s=i.find("img").attr("src"),o={};o.pic={small:n,tiny:s,origin:s.replace("_tiny",""),sizeW:1e3,sizeH:534},a.push(o)})}function n(){c.photoSwp(a)}var s=t("#gsZpImages"),o="",a=[];if(i(),o+='<div class="gs-zq-images ">',o+='<div class="gs-zq-title-lev1">图库</div>',o+='<div class="gs-zq-swp gsZqSwpPicDad">',o+='<div class="swiper-container gsZqSwp">',o+='<div class="swiper-wrapper">',t.each(a,function(t,i){o+='<div class="swiper-slide"><a class="gsZqPicLook" data-idx="'+t+'"><img src="'+i.pic.tiny+'" alt="gs"></a></div>'}),o+="",o+="</div></div></div></div>",s.html(o),t(".gsZqSwpPicDad").gsZqSwp(),"undefined"==typeof PhotoSwipe){var r='<link rel="stylesheet" href="//j.gamersky.com/css/??g/lib/photoswipe.min.css,g/lib/default-skin.min.css,?dtcode='+e+'"></link>';t("head").append(r),t.getScript("//j.gamersky.com/js/??g/lib/photoswipe.min.js,g/lib/photoswipe-ui-default.min.js",function(){n()})}else n()}});var c={DomExist:function(t,i){t.length>0&&"function"==typeof i&&i()},infoIntroduce:function(){this.DomExist(t(".gsZqGameInfoIntro"),function(){t(".gsZqGameInfoIntro").gsZqInfoIntro()})},infoPlatformTime:function(){this.DomExist(t(".gsZqGameInfo"),function(){t(".gsZqGameInfo").gsZqInfoPlatformTime()})},swp:function(){this.DomExist(t(".gsZqSwpDad"),function(){t(".gsZqSwpDad").gsZqSwp()})},tab:function(){this.DomExist(t(".gsZqTab"),function(){t(".gsZqTab").gsZqTab()})},gl:function(){this.DomExist(t("#gsZqStrategy"),function(){t("#gsZqStrategy").gsZqGl()})},nav:function(){this.DomExist(t(".gsZqNav"),function(){t(".gsZqNav").gsZqNav()})},moreOnce:function(){this.DomExist(t(".gsZqGetMoreOnce"),function(){t(".gsZqGetMoreOnce").gsZqGetMoreOnce()})},more:function(){this.DomExist(t(".gsZqGetMore"),function(){t(".gsZqGetMore").gsZqGetMore()})},commentCount:function(){this.DomExist(t(".gsZqComment"),function(){t(".gsZqComment").gsZqGetCommentCount()})},setMinHeight:function(){this.DomExist(t(".gsZqLp"),function(){t(".gsZqLp").gsZqSetMinHeight()})},getRating:function(){this.DomExist(t(".gsZqRating"),function(){t(".gsZqRating").gsZqGetRating()})},addSwpOnce:function(){var i='<div class="pswp pswp-zq pswpZq" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div>';i+='<div class="pswp__ui pswp__ui--hidden">',i+='<div class="pswp__bot-bar">',i+='<a class="pswp-zq-origin-btn pswpBtnOrigin pswp__single-tap" title="查看原图">查看原图</a>',i+='<a class="pswp-zq-save-btn pswpBtnSave pswp__single-tap" title="保存原图"></a>',i+="</div>",i+='<div class="pswp__top-bar">',i+='<div class="pswp__counter"></div>',i+='<button class="pswp__button pswp__button--close" title="关闭"></button>',i+='<button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="上一张"></button> <button class="pswp__button pswp__button--arrow--right" title="下一张"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div>',i+="</div></div>",t("body").append(i)},photoSwp:function(i){var n=function(n){var s=function(i){var n=[];return t.each(i,function(t,i){var s={msrc:i.pic.tiny,src:i.pic.small,w:i.pic.sizeW,h:i.pic.sizeH,ori:i.pic.origin};n.push(s)}),n},o=function(n,o,e,a,c){function r(i){t(".pswpZq").find(".pswpBtnSave").attr({target:"_blank",href:"//pic.gamersky.com/down/index?url="+g[i].ori})}function d(){t(".pswpZq").on("click",".pswpBtnOrigin",function(){t(".pswpZq").find(".pswp__img").each(function(){var i=t(this);i.attr("src")===g[u].src&&i.attr("src",g[u].ori)})})}var p,f,g,l=t(".pswpZq")[0];g=s(i),f={shareEl:!1,fullscreenEl:!1,zoomEl:!1,bgOpacity:1,showHideOpacity:0,galleryUID:e,history:!1,tapToClose:!0,tapToToggleControls:!1,index:o,getThumbBoundsFn:function(t){var i=n.find("img")[0],s=window.pageYOffset||document.documentElement.scrollTop,o=i.getBoundingClientRect();return{x:o.left,y:o.top+s,w:o.width}}},p=new PhotoSwipe(l,PhotoSwipeUI_Default,g,f),p.init();var u=0;p.listen("initialZoomIn",function(){u=p.getCurrentIndex(),r(u),t(".pswpZq").animate({opacity:1},333)}),p.listen("initialZoomOut",function(){t(".pswpZq").animate({opacity:0},200)}),p.listen("afterChange",function(){u=p.getCurrentIndex(),r(u)}),d()},e=t(n);e.attr("data-pswp-uid",1),e.find(".gsZqPicLook").on("click",function(){var i=t(this),n=i.data("idx");o(i,n,1)})};n(".gsZqSwpPicDad")},createPic:function(){var i=this;this.DomExist(t("#demo0"),function(){t("#demo0").gsZqCreatePic(),i.addSwpOnce()})},openClub:function(){var i=this,n=t("#QZCMT");""!==t.trim(n.attr("clubId"))||""!==t.trim(n.attr("topicId"))?i.DomExist(n,function(){t.getScript("//j.gamersky.com/web2015/qzcomment/js/qzcmtconfig.wap.js"),t(".gs-zq-club").addClass("gsZqNavPos4"),t(".gs-zq-ku-comm").remove()}):(t(".gs-zq-club").hide(),t(".gs-zq-ku-comm").on("click",".btnDetailMore",function(i){console.log("gs-zq-ku-comm"),t(this).off(),i.preventDefault(),window.location.href=t(".gs-zq-ku-comm .gs-more").attr("href")}))},pzShowHide:function(){t("#pzMain").length>0&&t(".pz_data").find(".PZXQ").length<1&&t(".gs-zq-config").hide()},init:function(){var t=this;t.nav(),t.infoPlatformTime(),t.infoIntroduce(),t.tab(),t.swp(),t.gl(),t.setMinHeight(),t.moreOnce(),t.more(),t.commentCount(),t.getRating(),t.createPic(),t.openClub(),t.pzShowHide()}};c.init()}(jQuery);
//# sourceMappingURL=wap.zq.min.js.map
